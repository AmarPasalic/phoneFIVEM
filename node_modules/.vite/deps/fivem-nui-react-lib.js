import {
  require_jsx_runtime
} from "./chunk-RVP4W45E.js";
import {
  require_react
} from "./chunk-AZ4MYHDF.js";
import {
  __commonJS
} from "./chunk-ROME4SDB.js";

// node_modules/.pnpm/fivem-nui-react-lib@2.3.13_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/fivem-nui-react-lib/dist/nui-events/utils/eventNameFactory.js
var require_eventNameFactory = __commonJS({
  "node_modules/.pnpm/fivem-nui-react-lib@2.3.13_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/fivem-nui-react-lib/dist/nui-events/utils/eventNameFactory.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.eventNameFactory = void 0;
    var eventNameFactory = function(app, method) {
      return app + ":" + method;
    };
    exports.eventNameFactory = eventNameFactory;
  }
});

// node_modules/.pnpm/fivem-nui-react-lib@2.3.13_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/fivem-nui-react-lib/dist/nui-events/hooks/useNuiEvent.js
var require_useNuiEvent = __commonJS({
  "node_modules/.pnpm/fivem-nui-react-lib@2.3.13_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/fivem-nui-react-lib/dist/nui-events/hooks/useNuiEvent.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.useNuiEvent = void 0;
    var react_1 = require_react();
    var eventNameFactory_1 = require_eventNameFactory();
    function addEventListener(element, type, handler) {
      element.addEventListener(type, handler);
    }
    var useNuiEvent = function(app, method, handler) {
      var savedHandler = react_1.useRef();
      react_1.useEffect(function() {
        savedHandler.current = handler;
      }, [handler]);
      react_1.useEffect(function() {
        var eventName = eventNameFactory_1.eventNameFactory(app, method);
        var eventListener = function(event) {
          if (savedHandler.current && savedHandler.current.call) {
            var data = event.data;
            var newData = data;
            savedHandler.current(newData);
          }
        };
        addEventListener(window, eventName, eventListener);
        return function() {
          return window.removeEventListener(eventName, eventListener);
        };
      }, [app, method]);
    };
    exports.useNuiEvent = useNuiEvent;
  }
});

// node_modules/.pnpm/fivem-nui-react-lib@2.3.13_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/fivem-nui-react-lib/dist/nui-events/context/NuiContext.js
var require_NuiContext = __commonJS({
  "node_modules/.pnpm/fivem-nui-react-lib@2.3.13_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/fivem-nui-react-lib/dist/nui-events/context/NuiContext.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.NuiContext = void 0;
    var react_1 = require_react();
    exports.NuiContext = react_1.createContext(null);
  }
});

// node_modules/.pnpm/fivem-nui-react-lib@2.3.13_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/fivem-nui-react-lib/dist/nui-events/hooks/useNuiCallback.js
var require_useNuiCallback = __commonJS({
  "node_modules/.pnpm/fivem-nui-react-lib@2.3.13_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/fivem-nui-react-lib/dist/nui-events/hooks/useNuiCallback.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.useNuiCallback = void 0;
    var react_1 = require_react();
    var NuiContext_1 = require_NuiContext();
    var eventNameFactory_1 = require_eventNameFactory();
    var useNuiEvent_1 = require_useNuiEvent();
    var useNuiCallback = function(app, method, handler, errHandler) {
      var _a = react_1.useContext(NuiContext_1.NuiContext), sendAbortable = _a.sendAbortable, callbackTimeout = _a.callbackTimeout;
      var fetchRef = react_1.useRef();
      var timeoutRef = react_1.useRef();
      var eventNameRef = react_1.useRef(eventNameFactory_1.eventNameFactory(app, method));
      var methodNameRef = react_1.useRef(method);
      var appNameRef = react_1.useRef(app);
      var _b = react_1.useState(false), timedOut = _b[0], setTimedOut = _b[1];
      var _c = react_1.useState(false), failed = _c[0], setFailed = _c[1];
      var _d = react_1.useState(false), loading = _d[0], setLoading = _d[1];
      var _e = react_1.useState(null), error = _e[0], setError = _e[1];
      var _f = react_1.useState(null), response = _f[0], setResponse = _f[1];
      var onSuccess = react_1.useCallback(function(data) {
        if (!loading) {
          return;
        }
        timeoutRef.current && clearTimeout(timeoutRef.current);
        if (timedOut) {
          return;
        }
        setResponse(data);
        setError(null);
        setLoading(false);
        handler === null || handler === void 0 ? void 0 : handler(data);
      }, [handler, timedOut, loading]);
      var onError = react_1.useCallback(function(err) {
        timeoutRef.current && clearTimeout(timeoutRef.current);
        setError(err);
        setResponse(null);
        setLoading(false);
        errHandler === null || errHandler === void 0 ? void 0 : errHandler(err);
      }, [errHandler]);
      useNuiEvent_1.useNuiEvent(appNameRef.current, methodNameRef.current + "Success", onSuccess);
      useNuiEvent_1.useNuiEvent(appNameRef.current, methodNameRef.current + "Error", onError);
      var fetch2 = react_1.useCallback(
        function(data, options) {
          setLoading(function(curr) {
            if (!curr) {
              setTimedOut(false);
              setFailed(false);
              setError(null);
              setResponse(null);
              fetchRef.current = sendAbortable(methodNameRef.current, data);
              fetchRef.current.promise.catch(function(e) {
                if (!timedOut) {
                  onError(e);
                  setFailed(true);
                  timeoutRef.current = void 0;
                  fetchRef.current = void 0;
                }
              });
              var _options = options || { timeout: callbackTimeout };
              var timeoutTime_1 = _options.timeout === false ? false : _options.timeout || callbackTimeout;
              if (timeoutTime_1 && !failed) {
                clearTimeout(timeoutRef.current);
                timeoutRef.current = setTimeout(function() {
                  setTimedOut(true);
                  onError(new Error('fivem-nui-react-lib: "' + eventNameRef.current + '" event callback timed out after ' + timeoutTime_1 + " milliseconds"));
                  fetchRef.current && fetchRef.current.abort();
                  timeoutRef.current = void 0;
                  fetchRef.current = void 0;
                }, timeoutTime_1);
              }
              return true;
            }
            return curr;
          });
        },
        // eslint-disable-next-line react-hooks/exhaustive-deps
        []
      );
      return [fetch2, { loading, response, error }];
    };
    exports.useNuiCallback = useNuiCallback;
  }
});

// node_modules/.pnpm/fivem-nui-react-lib@2.3.13_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/fivem-nui-react-lib/dist/nui-events/hooks/useNuiRequest.js
var require_useNuiRequest = __commonJS({
  "node_modules/.pnpm/fivem-nui-react-lib@2.3.13_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/fivem-nui-react-lib/dist/nui-events/hooks/useNuiRequest.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.useNuiRequest = void 0;
    var react_1 = require_react();
    var NuiContext_1 = require_NuiContext();
    var useNuiRequest = function(_a) {
      var _b = _a === void 0 ? {} : _a, resource = _b.resource;
      var context = react_1.useContext(NuiContext_1.NuiContext);
      if (!context) {
        throw new Error("fivem-nui-react-lib: useNuiRequest must be used inside NuiProvider passing the `resource` prop");
      }
      var send = context.send, sendAbortable = context.sendAbortable;
      return react_1.useMemo(function() {
        return {
          send: function(event, data) {
            if (data === void 0) {
              data = {};
            }
            return send(event, data, resource);
          },
          sendAbortable: function(event, data) {
            if (data === void 0) {
              data = {};
            }
            return sendAbortable(event, data, resource);
          }
        };
      }, [send, sendAbortable, resource]);
    };
    exports.useNuiRequest = useNuiRequest;
  }
});

// node_modules/.pnpm/fivem-nui-react-lib@2.3.13_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/fivem-nui-react-lib/dist/nui-events/providers/NuiProvider.js
var require_NuiProvider = __commonJS({
  "node_modules/.pnpm/fivem-nui-react-lib@2.3.13_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/fivem-nui-react-lib/dist/nui-events/providers/NuiProvider.js"(exports) {
    "use strict";
    var __assign = exports && exports.__assign || function() {
      __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
          s = arguments[i];
          for (var p in s)
            if (Object.prototype.hasOwnProperty.call(s, p))
              t[p] = s[p];
        }
        return t;
      };
      return __assign.apply(this, arguments);
    };
    var __awaiter = exports && exports.__awaiter || function(thisArg, _arguments, P, generator) {
      function adopt(value) {
        return value instanceof P ? value : new P(function(resolve) {
          resolve(value);
        });
      }
      return new (P || (P = Promise))(function(resolve, reject) {
        function fulfilled(value) {
          try {
            step(generator.next(value));
          } catch (e) {
            reject(e);
          }
        }
        function rejected(value) {
          try {
            step(generator["throw"](value));
          } catch (e) {
            reject(e);
          }
        }
        function step(result) {
          result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);
        }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
      });
    };
    var __generator = exports && exports.__generator || function(thisArg, body) {
      var _ = { label: 0, sent: function() {
        if (t[0] & 1)
          throw t[1];
        return t[1];
      }, trys: [], ops: [] }, f, y, t, g;
      return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() {
        return this;
      }), g;
      function verb(n) {
        return function(v) {
          return step([n, v]);
        };
      }
      function step(op) {
        if (f)
          throw new TypeError("Generator is already executing.");
        while (_)
          try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done)
              return t;
            if (y = 0, t)
              op = [op[0] & 2, t.value];
            switch (op[0]) {
              case 0:
              case 1:
                t = op;
                break;
              case 4:
                _.label++;
                return { value: op[1], done: false };
              case 5:
                _.label++;
                y = op[1];
                op = [0];
                continue;
              case 7:
                op = _.ops.pop();
                _.trys.pop();
                continue;
              default:
                if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
                  _ = 0;
                  continue;
                }
                if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {
                  _.label = op[1];
                  break;
                }
                if (op[0] === 6 && _.label < t[1]) {
                  _.label = t[1];
                  t = op;
                  break;
                }
                if (t && _.label < t[2]) {
                  _.label = t[2];
                  _.ops.push(op);
                  break;
                }
                if (t[2])
                  _.ops.pop();
                _.trys.pop();
                continue;
            }
            op = body.call(thisArg, _);
          } catch (e) {
            op = [6, e];
            y = 0;
          } finally {
            f = t = 0;
          }
        if (op[0] & 5)
          throw op[1];
        return { value: op[0] ? op[1] : void 0, done: true };
      }
    };
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.NuiProvider = void 0;
    var jsx_runtime_1 = require_jsx_runtime();
    var react_1 = require_react();
    var NuiContext_1 = require_NuiContext();
    var eventNameFactory_1 = require_eventNameFactory();
    function abortableFetch(request, opts) {
      var controller = new AbortController();
      var signal = controller.signal;
      return {
        abort: function() {
          return controller.abort();
        },
        promise: fetch(request, __assign(__assign({}, opts), { signal }))
      };
    }
    function getParams(resource, event, data) {
      return [
        "https://" + resource + "/" + event,
        {
          method: "post",
          headers: {
            "Content-Type": "application/json; charset=UTF-8"
          },
          body: JSON.stringify(data)
        }
      ];
    }
    var DEFAULT_TIMEOUT = 1e4;
    var NuiProvider = function(_a) {
      var resource = _a.resource, children = _a.children, timeout = _a.timeout;
      var resourceRef = react_1.useRef(resource || "");
      var timeoutRef = react_1.useRef(timeout || DEFAULT_TIMEOUT);
      var eventListener = function(event) {
        var _a2 = event.data, app = _a2.app, method = _a2.method, data = _a2.data;
        if (app && method) {
          window.dispatchEvent(new MessageEvent(eventNameFactory_1.eventNameFactory(app, method), {
            data
          }));
        }
      };
      react_1.useEffect(function() {
        window.addEventListener("message", eventListener);
        return function() {
          return window.removeEventListener("message", eventListener);
        };
      }, []);
      var send = react_1.useCallback(function(event, data, res) {
        if (data === void 0) {
          data = {};
        }
        return __awaiter(void 0, void 0, void 0, function() {
          return __generator(this, function(_a2) {
            return [2, fetch.apply(void 0, getParams(res || resourceRef.current, event, data))];
          });
        });
      }, []);
      var sendAbortable = react_1.useCallback(function(event, data, res) {
        if (data === void 0) {
          data = {};
        }
        return abortableFetch.apply(void 0, getParams(res || resourceRef.current, event, data));
      }, []);
      return jsx_runtime_1.jsx(NuiContext_1.NuiContext.Provider, __assign({ value: {
        send,
        sendAbortable,
        resource: resourceRef.current,
        callbackTimeout: timeoutRef.current
      } }, { children }), void 0);
    };
    exports.NuiProvider = NuiProvider;
  }
});

// node_modules/.pnpm/fivem-nui-react-lib@2.3.13_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/fivem-nui-react-lib/dist/index.js
var require_dist = __commonJS({
  "node_modules/.pnpm/fivem-nui-react-lib@2.3.13_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/fivem-nui-react-lib/dist/index.js"(exports) {
    var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {
      if (k2 === void 0)
        k2 = k;
      Object.defineProperty(o, k2, { enumerable: true, get: function() {
        return m[k];
      } });
    } : function(o, m, k, k2) {
      if (k2 === void 0)
        k2 = k;
      o[k2] = m[k];
    });
    var __exportStar = exports && exports.__exportStar || function(m, exports2) {
      for (var p in m)
        if (p !== "default" && !Object.prototype.hasOwnProperty.call(exports2, p))
          __createBinding(exports2, m, p);
    };
    Object.defineProperty(exports, "__esModule", { value: true });
    __exportStar(require_useNuiEvent(), exports);
    __exportStar(require_useNuiCallback(), exports);
    __exportStar(require_useNuiRequest(), exports);
    __exportStar(require_NuiContext(), exports);
    __exportStar(require_NuiProvider(), exports);
    __exportStar(require_eventNameFactory(), exports);
  }
});
export default require_dist();
//# sourceMappingURL=fivem-nui-react-lib.js.map
